kube-prometheus-stack:
  grafana:
    enabled: false
  windowsMonitoring:
    enabled: false
  alertmanager:
    enabled: false

  nameOverride: "k8s-prometheus"
  prometheus:
    prometheusSpec:
#      additionalArgs:
#        - name: web.config.file
#          value: "/etc/ces-config/web.config.yaml"
      volumes:
      - name: ces-config
        persistentVolumeClaim:
          claimName: k8s-prometheus-config
      - name: initial-config
        configMap:
          name: k8s-prometheus-initial-config
      containers:
      - name: serviceaccount
        image: cloudogu/k8s-prometheus:2.50.1-1
        imagePullPolicy: Always
        env:
          - name: WEB_CONFIG_FILE
            value: "/config/web.config.yaml"
          - name: API_KEY
            valueFrom:
              secretKeyRef:
                name: k8s-prometheus-service-account-api
                key: apiKey
        ports:
          - containerPort: 8087
        volumeMounts:
          - name: ces-config
            mountPath: /config
      initContainers:
      - name: config-init
        image: busybox:1.36
        command:
          - 'sh'
          - '-c'
          - 'cp -n /initial-config/web.config.yaml /config/web.config.yaml'
        volumeMounts:
          - name: ces-config
            mountPath: /config
          - name: initial-config
            mountPath: /initial-config

#prometheus:
#  nameOverride: "k8s-prometheus"
#  kube-state-metrics:
#    enabled: true
#    image:
#      registry: registry.k8s.io
#      repository: kube-state-metrics/kube-state-metrics
#      tag: "v2.10.1"
#  alertmanager:
#    enabled: false
#  prometheus-node-exporter:
#    enabled: true
#    image:
#      registry: quay.io
#      repository: prometheus/node-exporter
#      tag: "v1.7.0"
#  prometheus-pushgateway:
#    enabled: false
#  configmapReload:
#    prometheus:
#      image:
#        repository: quay.io/prometheus-operator/prometheus-config-reloader
#        tag: v0.71.2
#  server:
#    image:
#      repository: quay.io/prometheus/prometheus
#      tag: "v2.50.1"
#    tcpSocketProbeEnabled: true
#    extraArgs:
#      web.config.file: /etc/ces-config/web.config.yaml
#    extraVolumeMounts:
#      - mountPath: /etc/ces-config
#        name: ces-config
#    podLabels:
#      app: "ces"
#      app.kubernetes.io/name: "k8s-prometheus"
#      ces.cloudogu.com/serviceaccount-provider: "k8s-prometheus"
#    extraVolumes:
#      - name: ces-config
#        persistentVolumeClaim:
#          claimName: k8s-prometheus-config
#      - name: initial-config
#        configMap:
#          name: k8s-prometheus-initial-config
#    extraInitContainers:
#      - name: config-init
#        image: busybox:1.36
#        command:
#          - 'sh'
#          - '-c'
#          - 'cp -n /initial-config/web.config.yaml /config/web.config.yaml'
#        volumeMounts:
#          - name: ces-config
#            mountPath: /config
#          - name: initial-config
#            mountPath: /initial-config
#    sidecarContainers:
#      serviceaccount:
#        image: cloudogu/k8s-prometheus:2.50.1-1
#        imagePullPolicy: Always
#        env:
#          - name: WEB_CONFIG_FILE
#            value: "/config/web.config.yaml"
#          - name: API_KEY
#            valueFrom:
#              secretKeyRef:
#                name: k8s-prometheus-service-account-api
#                key: apiKey
#        ports:
#          - containerPort: 8080
#        volumeMounts:
#          - name: ces-config
#            mountPath: /config
